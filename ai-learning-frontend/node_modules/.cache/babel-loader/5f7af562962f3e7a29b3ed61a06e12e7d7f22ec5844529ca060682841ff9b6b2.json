{"ast":null,"code":"import httpClient from \"./httpClient\";\nimport axios from \"axios\";\nimport { CONFIG } from \"../config\";\nimport { saveUser, clearAuthData, getToken } from \"../utils/localStorage\"; // AJOUT: getToken\n\n/**\n * üîê Connexion utilisateur\n * @param {string} email\n * @param {string} password\n * @returns {Promise<{jwt: string, user: object}>}\n */\nexport const login = async (email, password) => {\n  try {\n    // Utiliser axios directement pour √©viter que httpClient ajoute le token\n    // La route /auth/local doit √™tre accessible sans authentification\n    const {\n      data\n    } = await axios.post(`${CONFIG.API_URL}/auth/local`, {\n      identifier: email.trim().toLowerCase(),\n      password\n    }, {\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    });\n\n    // Ne pas sauvegarder ici, laisser loginUser dans le contexte le faire\n    // Cela √©vite la double sauvegarde et assure la coh√©rence\n\n    return data;\n  } catch (error) {\n    var _error$response, _error$response2, _error$response4, _error$response4$data;\n    console.error(\"‚ùå Erreur lors de la connexion :\", ((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.data) || error.message);\n\n    // Gestion sp√©cifique des erreurs 403\n    if (((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.status) === 403) {\n      var _error$response3, _error$response3$data, _error$response3$data2;\n      const errorMessage = ((_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : (_error$response3$data = _error$response3.data) === null || _error$response3$data === void 0 ? void 0 : (_error$response3$data2 = _error$response3$data.error) === null || _error$response3$data2 === void 0 ? void 0 : _error$response3$data2.message) || \"Acc√®s refus√©. V√©rifiez vos permissions dans Strapi pour la route /auth/local\";\n      throw new Error(errorMessage);\n    }\n\n    // Gestion des autres erreurs\n    if ((_error$response4 = error.response) !== null && _error$response4 !== void 0 && (_error$response4$data = _error$response4.data) !== null && _error$response4$data !== void 0 && _error$response4$data.error) {\n      const errorMessage = error.response.data.error.message || \"Erreur lors de la connexion\";\n      throw new Error(errorMessage);\n    }\n    throw error;\n  }\n};\n\n/**\n * üë§ R√©cup√©rer les informations de l'utilisateur connect√©\n * @returns {Promise<object>}\n */\nexport const getMe = async () => {\n  try {\n    var _data$role, _data$role2, _data$role3, _data$role4;\n    const token = getToken(); // R√âCUP√âRER LE TOKEN\n\n    if (!token) {\n      throw new Error(\"Aucun token d'authentification trouv√©\");\n    }\n\n    // UTILISER AXIOS DIRECTEMENT AU LIEU DE httpClient\n    const {\n      data\n    } = await axios.get(`${CONFIG.API_URL}/users/me?populate=role,subjects`,\n    // D√âJ√Ä CORRECT - populate=role,subjects\n    {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    });\n\n    // DEBUG D√âTAILL√â\n    console.log(\"üîç getMe() - Donn√©es utilisateur COMPL√àTES:\", data);\n    console.log(\"üé≠ R√¥le peupl√©:\", data.role);\n    console.log(\"üìã Structure du r√¥le:\", {\n      id: (_data$role = data.role) === null || _data$role === void 0 ? void 0 : _data$role.id,\n      name: (_data$role2 = data.role) === null || _data$role2 === void 0 ? void 0 : _data$role2.name,\n      type: (_data$role3 = data.role) === null || _data$role3 === void 0 ? void 0 : _data$role3.type,\n      description: (_data$role4 = data.role) === null || _data$role4 === void 0 ? void 0 : _data$role4.description\n    });\n    console.log(\"üìö Subjects:\", data.subjects);\n\n    // V√âRIFICATION CRITIQUE DU R√îLE\n    if (!data.role) {\n      console.error(\"‚ùå CRITIQUE: R√¥le non peupl√© dans la r√©ponse!\");\n    } else if (!data.role.name) {\n      console.error(\"‚ùå CRITIQUE: R√¥le sans propri√©t√© 'name'!\", data.role);\n    } else {\n      console.log(\"‚úÖ R√¥le correctement peupl√©:\", data.role.name);\n    }\n    saveUser(data);\n    return data;\n  } catch (error) {\n    var _error$response5, _error$response6;\n    console.error(\"‚ùå Erreur lors de la r√©cup√©ration du profil :\", ((_error$response5 = error.response) === null || _error$response5 === void 0 ? void 0 : _error$response5.data) || error.message);\n\n    // Si erreur 401 (non autoris√©), d√©connecter l'utilisateur\n    if (((_error$response6 = error.response) === null || _error$response6 === void 0 ? void 0 : _error$response6.status) === 401) {\n      clearAuthData();\n      throw new Error(\"Session expir√©e. Veuillez vous reconnecter.\");\n    }\n    throw error;\n  }\n};\n\n/**\n * üìù Inscription utilisateur avec attribution du r√¥le\n * @param {string} username\n * @param {string} email\n * @param {string} password\n * @param {string} roleName - Nom du r√¥le (student ou teacher)\n * @returns {Promise<{jwt: string, user: object}>}\n */\nexport const register = async (username, email, password, roleName) => {\n  try {\n    var _rolesRes, _rolesRes$roles;\n    // Validation des param√®tres\n    if (!username || !email || !password) {\n      throw new Error(\"Tous les champs sont requis\");\n    }\n\n    // √âtape 1: Cr√©er l'utilisateur (Strapi n'accepte pas le param√®tre role dans /auth/local/register)\n    let registerRes;\n    try {\n      const response = await httpClient.post(\"/auth/local/register\", {\n        username: username.trim(),\n        email: email.trim().toLowerCase(),\n        password\n      });\n      registerRes = response.data;\n    } catch (registerError) {\n      var _registerError$respon;\n      // G√©rer les erreurs de validation Strapi\n      const errorData = (_registerError$respon = registerError.response) === null || _registerError$respon === void 0 ? void 0 : _registerError$respon.data;\n      if (errorData !== null && errorData !== void 0 && errorData.error) {\n        var _errorData$error$deta;\n        const errorMessage = errorData.error.message || \"Erreur lors de l'inscription\";\n\n        // Extraire les d√©tails d'erreur si disponibles\n        if ((_errorData$error$deta = errorData.error.details) !== null && _errorData$error$deta !== void 0 && _errorData$error$deta.errors) {\n          const errors = errorData.error.details.errors;\n          const firstError = Object.values(errors)[0];\n          if (firstError && firstError[0]) {\n            throw new Error(firstError[0].message || errorMessage);\n          }\n        }\n        throw new Error(errorMessage);\n      }\n      throw registerError;\n    }\n    if (!registerRes || !registerRes.jwt || !registerRes.user) {\n      throw new Error(\"R√©ponse invalide du serveur lors de l'inscription\");\n    }\n    const token = registerRes.jwt;\n    const userId = registerRes.user.id;\n\n    // √âtape 2: R√©cup√©rer tous les r√¥les disponibles (sans token car route publique)\n    let rolesRes;\n    try {\n      const response = await httpClient.get(\"/users-permissions/roles\");\n      rolesRes = response.data;\n    } catch (rolesError) {\n      console.warn(\"‚ö†Ô∏è Impossible de r√©cup√©rer les r√¥les:\", rolesError);\n      // Si on ne peut pas r√©cup√©rer les r√¥les, retourner les donn√©es de base\n      return {\n        jwt: token,\n        user: registerRes.user\n      };\n    }\n\n    // √âtape 3: Trouver le r√¥le s√©lectionn√©\n    const selectedRole = (_rolesRes = rolesRes) === null || _rolesRes === void 0 ? void 0 : (_rolesRes$roles = _rolesRes.roles) === null || _rolesRes$roles === void 0 ? void 0 : _rolesRes$roles.find(r => r.name.toLowerCase() === roleName.toLowerCase());\n    if (!selectedRole) {\n      console.warn(`‚ö†Ô∏è R√¥le \"${roleName}\" introuvable, utilisation du r√¥le par d√©faut`);\n      // Retourner les donn√©es de base si le r√¥le n'est pas trouv√©\n      return {\n        jwt: token,\n        user: registerRes.user\n      };\n    }\n\n    // √âtape 4: Mettre √† jour le r√¥le de l'utilisateur avec le token JWT obtenu\n    // On utilise axios directement car httpClient utilise le token du localStorage qui n'existe pas encore\n    try {\n      await axios.put(`${CONFIG.API_URL}/users/${userId}`, {\n        role: selectedRole.id\n      }, {\n        headers: {\n          Authorization: `Bearer ${token}`,\n          \"Content-Type\": \"application/json\"\n        }\n      });\n\n      // √âtape 5: R√©cup√©rer les donn√©es utilisateur mises √† jour avec le r√¥le\n      const {\n        data: updatedUser\n      } = await axios.get(`${CONFIG.API_URL}/users/${userId}?populate=role`, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n\n      // Retourner les donn√©es avec le r√¥le mis √† jour\n      return {\n        jwt: token,\n        user: updatedUser\n      };\n    } catch (updateError) {\n      var _updateError$response;\n      // Si la mise √† jour du r√¥le √©choue, retourner quand m√™me les donn√©es de base\n      console.warn(\"‚ö†Ô∏è Impossible de mettre √† jour le r√¥le, l'utilisateur a √©t√© cr√©√© avec le r√¥le par d√©faut:\", ((_updateError$response = updateError.response) === null || _updateError$response === void 0 ? void 0 : _updateError$response.data) || updateError.message);\n\n      // Retourner les donn√©es de base m√™me si la mise √† jour du r√¥le √©choue\n      return {\n        jwt: token,\n        user: registerRes.user\n      };\n    }\n  } catch (error) {\n    var _error$response7;\n    console.error(\"‚ùå Erreur lors de l'inscription :\", ((_error$response7 = error.response) === null || _error$response7 === void 0 ? void 0 : _error$response7.data) || error.message);\n    throw error;\n  }\n};\n\n/**\n * üö™ D√©connexion utilisateur\n */\nexport const logout = () => {\n  clearAuthData();\n};","map":{"version":3,"names":["httpClient","axios","CONFIG","saveUser","clearAuthData","getToken","login","email","password","data","post","API_URL","identifier","trim","toLowerCase","headers","error","_error$response","_error$response2","_error$response4","_error$response4$data","console","response","message","status","_error$response3","_error$response3$data","_error$response3$data2","errorMessage","Error","getMe","_data$role","_data$role2","_data$role3","_data$role4","token","get","Authorization","log","role","id","name","type","description","subjects","_error$response5","_error$response6","register","username","roleName","_rolesRes","_rolesRes$roles","registerRes","registerError","_registerError$respon","errorData","_errorData$error$deta","details","errors","firstError","Object","values","jwt","user","userId","rolesRes","rolesError","warn","selectedRole","roles","find","r","put","updatedUser","updateError","_updateError$response","_error$response7","logout"],"sources":["C:/Users/Admin/AI_Educative/ai-learning-frontend/src/api/auth.js"],"sourcesContent":["import httpClient from \"./httpClient\";\nimport axios from \"axios\";\nimport { CONFIG } from \"../config\";\nimport { saveUser, clearAuthData, getToken } from \"../utils/localStorage\"; // AJOUT: getToken\n\n/**\n * üîê Connexion utilisateur\n * @param {string} email\n * @param {string} password\n * @returns {Promise<{jwt: string, user: object}>}\n */\nexport const login = async (email, password) => {\n  try {\n    // Utiliser axios directement pour √©viter que httpClient ajoute le token\n    // La route /auth/local doit √™tre accessible sans authentification\n    const { data } = await axios.post(\n      `${CONFIG.API_URL}/auth/local`,\n      {\n        identifier: email.trim().toLowerCase(),\n        password,\n      },\n      {\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n      }\n    );\n    \n    // Ne pas sauvegarder ici, laisser loginUser dans le contexte le faire\n    // Cela √©vite la double sauvegarde et assure la coh√©rence\n    \n    return data;\n  } catch (error) {\n    console.error(\"‚ùå Erreur lors de la connexion :\", error.response?.data || error.message);\n    \n    // Gestion sp√©cifique des erreurs 403\n    if (error.response?.status === 403) {\n      const errorMessage = \n        error.response?.data?.error?.message || \n        \"Acc√®s refus√©. V√©rifiez vos permissions dans Strapi pour la route /auth/local\";\n      \n      throw new Error(errorMessage);\n    }\n    \n    // Gestion des autres erreurs\n    if (error.response?.data?.error) {\n      const errorMessage = error.response.data.error.message || \"Erreur lors de la connexion\";\n      throw new Error(errorMessage);\n    }\n    \n    throw error;\n  }\n};\n\n/**\n * üë§ R√©cup√©rer les informations de l'utilisateur connect√©\n * @returns {Promise<object>}\n */\nexport const getMe = async () => {\n  try {\n    const token = getToken(); // R√âCUP√âRER LE TOKEN\n    \n    if (!token) {\n      throw new Error(\"Aucun token d'authentification trouv√©\");\n    }\n\n    // UTILISER AXIOS DIRECTEMENT AU LIEU DE httpClient\n    const { data } = await axios.get(\n      `${CONFIG.API_URL}/users/me?populate=role,subjects`, // D√âJ√Ä CORRECT - populate=role,subjects\n      {\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n      }\n    );\n    \n    // DEBUG D√âTAILL√â\n    console.log(\"üîç getMe() - Donn√©es utilisateur COMPL√àTES:\", data);\n    console.log(\"üé≠ R√¥le peupl√©:\", data.role);\n    console.log(\"üìã Structure du r√¥le:\", {\n      id: data.role?.id,\n      name: data.role?.name,\n      type: data.role?.type,\n      description: data.role?.description\n    });\n    console.log(\"üìö Subjects:\", data.subjects);\n    \n    // V√âRIFICATION CRITIQUE DU R√îLE\n    if (!data.role) {\n      console.error(\"‚ùå CRITIQUE: R√¥le non peupl√© dans la r√©ponse!\");\n    } else if (!data.role.name) {\n      console.error(\"‚ùå CRITIQUE: R√¥le sans propri√©t√© 'name'!\", data.role);\n    } else {\n      console.log(\"‚úÖ R√¥le correctement peupl√©:\", data.role.name);\n    }\n    \n    saveUser(data);\n    return data;\n  } catch (error) {\n    console.error(\"‚ùå Erreur lors de la r√©cup√©ration du profil :\", error.response?.data || error.message);\n    \n    // Si erreur 401 (non autoris√©), d√©connecter l'utilisateur\n    if (error.response?.status === 401) {\n      clearAuthData();\n      throw new Error(\"Session expir√©e. Veuillez vous reconnecter.\");\n    }\n    \n    throw error;\n  }\n};\n\n/**\n * üìù Inscription utilisateur avec attribution du r√¥le\n * @param {string} username\n * @param {string} email\n * @param {string} password\n * @param {string} roleName - Nom du r√¥le (student ou teacher)\n * @returns {Promise<{jwt: string, user: object}>}\n */\nexport const register = async (username, email, password, roleName) => {\n  try {\n    // Validation des param√®tres\n    if (!username || !email || !password) {\n      throw new Error(\"Tous les champs sont requis\");\n    }\n\n    // √âtape 1: Cr√©er l'utilisateur (Strapi n'accepte pas le param√®tre role dans /auth/local/register)\n    let registerRes;\n    try {\n      const response = await httpClient.post(\"/auth/local/register\", {\n        username: username.trim(),\n        email: email.trim().toLowerCase(),\n        password,\n      });\n      registerRes = response.data;\n    } catch (registerError) {\n      // G√©rer les erreurs de validation Strapi\n      const errorData = registerError.response?.data;\n      if (errorData?.error) {\n        const errorMessage = errorData.error.message || \"Erreur lors de l'inscription\";\n        \n        // Extraire les d√©tails d'erreur si disponibles\n        if (errorData.error.details?.errors) {\n          const errors = errorData.error.details.errors;\n          const firstError = Object.values(errors)[0];\n          if (firstError && firstError[0]) {\n            throw new Error(firstError[0].message || errorMessage);\n          }\n        }\n        \n        throw new Error(errorMessage);\n      }\n      throw registerError;\n    }\n\n    if (!registerRes || !registerRes.jwt || !registerRes.user) {\n      throw new Error(\"R√©ponse invalide du serveur lors de l'inscription\");\n    }\n\n    const token = registerRes.jwt;\n    const userId = registerRes.user.id;\n\n    // √âtape 2: R√©cup√©rer tous les r√¥les disponibles (sans token car route publique)\n    let rolesRes;\n    try {\n      const response = await httpClient.get(\"/users-permissions/roles\");\n      rolesRes = response.data;\n    } catch (rolesError) {\n      console.warn(\"‚ö†Ô∏è Impossible de r√©cup√©rer les r√¥les:\", rolesError);\n      // Si on ne peut pas r√©cup√©rer les r√¥les, retourner les donn√©es de base\n      return {\n        jwt: token,\n        user: registerRes.user,\n      };\n    }\n    \n    // √âtape 3: Trouver le r√¥le s√©lectionn√©\n    const selectedRole = rolesRes?.roles?.find(\n      (r) => r.name.toLowerCase() === roleName.toLowerCase()\n    );\n\n    if (!selectedRole) {\n      console.warn(`‚ö†Ô∏è R√¥le \"${roleName}\" introuvable, utilisation du r√¥le par d√©faut`);\n      // Retourner les donn√©es de base si le r√¥le n'est pas trouv√©\n      return {\n        jwt: token,\n        user: registerRes.user,\n      };\n    }\n\n    // √âtape 4: Mettre √† jour le r√¥le de l'utilisateur avec le token JWT obtenu\n    // On utilise axios directement car httpClient utilise le token du localStorage qui n'existe pas encore\n    try {\n      await axios.put(\n        `${CONFIG.API_URL}/users/${userId}`,\n        {\n          role: selectedRole.id,\n        },\n        {\n          headers: {\n            Authorization: `Bearer ${token}`,\n            \"Content-Type\": \"application/json\",\n          },\n        }\n      );\n\n      // √âtape 5: R√©cup√©rer les donn√©es utilisateur mises √† jour avec le r√¥le\n      const { data: updatedUser } = await axios.get(\n        `${CONFIG.API_URL}/users/${userId}?populate=role`,\n        {\n          headers: {\n            Authorization: `Bearer ${token}`,\n          },\n        }\n      );\n\n      // Retourner les donn√©es avec le r√¥le mis √† jour\n      return {\n        jwt: token,\n        user: updatedUser,\n      };\n    } catch (updateError) {\n      // Si la mise √† jour du r√¥le √©choue, retourner quand m√™me les donn√©es de base\n      console.warn(\n        \"‚ö†Ô∏è Impossible de mettre √† jour le r√¥le, l'utilisateur a √©t√© cr√©√© avec le r√¥le par d√©faut:\",\n        updateError.response?.data || updateError.message\n      );\n      \n      // Retourner les donn√©es de base m√™me si la mise √† jour du r√¥le √©choue\n      return {\n        jwt: token,\n        user: registerRes.user,\n      };\n    }\n  } catch (error) {\n    console.error(\"‚ùå Erreur lors de l'inscription :\", error.response?.data || error.message);\n    throw error;\n  }\n};\n\n/**\n * üö™ D√©connexion utilisateur\n */\nexport const logout = () => {\n  clearAuthData();\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}